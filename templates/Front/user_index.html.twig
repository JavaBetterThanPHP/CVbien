{% extends "front_base.html.twig" %}

{% block title %}
    {% if edit %}
        Dashboard - {{ parent() }}
    {% else %}
        {{ user.spaceName | default('User page') }} - {{ parent() }}
    {% endif %}
{% endblock %}

{% block header %}
    {% if edit %}
        {{ include('_header_dashboard.html.twig') }}
    {% endif %}
{% endblock %}

{% block content %}
    {% if user is defined %}

        {% if edit %}
            {# Values #}
            <input id="updateProfilePictureLink" name="updateProfilePictureLink" type="hidden"
                   value="{{ path('front_user_updateProfilePicture') }}">
            <input id="updateBannerLink" name="updateBannerLink" type="hidden"
                   value="{{ path('front_user_updateBanner') }}">
            <input id="userId" name="userId" type="hidden" value="{{ user.id }}">
            {# --- #}
        {% endif %}

        {# Display banner/pictures #}
        <div id="userBanner" class="bg-img img-fluid"
             style="background-image: url({{ vich_uploader_asset(user, 'bannerImageFile') }})">
            {# Profil picture #}
            <img id="profilePicture" class="border-fat rounded-circle profileImg mt-2"
                 src="{{ vich_uploader_asset(user, 'imageFile') }}"/>
            {# --- #}
        </div>

        {% if edit %}
            <div class="height-70 bg-dark">
                <button type="button" class="btn btn-sm btn-secondary dropdown-toggle ml-2 mt-2 mb-2"
                        data-toggle="dropdown"
                        aria-haspopup="true" aria-expanded="false">
                    Editer
                </button>
                <div class="dropdown-menu dropdown-menu-right">
                    <button id="btnInitCropProfile" class="dropdown-item" type="button"
                            data-toggle="modal"
                            data-target="#profilePictureModal">
                        Avatar
                    </button>
                    <button id="btnInitCropBanner" class="dropdown-item" type="button"
                            data-toggle="modal"
                            data-target="#bannerModal">
                        Banni√®re
                    </button>
                </div>
                <button type="button" class="btn btn-sm btn-secondary" data-toggle="modal" data-target="#moduleModal">
                    Ajouter
                </button>
                <button type="button" class="btn btn-sm btn-secondary" data-toggle="modal" data-target="#updateModal">
                    Update
                </button>
            </div>
        {% else %}
            <div class="height-10 bg-dark"></div>
        {% endif %}

        {# MODULE AREA - Zone des modules #}
        <div id="modContainer" class="container-fluid mt-5">
            <div id="modGrid" class="grid muuri">
                {{ user.userModulesGridHtmlString | raw }}
            </div>
        </div>
        {# --- #}

        {% if edit %}
            {{ include('Front/_modal_profile_picture.html.twig') }}
            {{ include('Front/_modal_banner_picture.html.twig') }}
            {{ include('Front/_modal_update.html.twig') }}
        {% endif %}

        {# ---- MODULE MODAL ---- #}
        {{ include('Front/module/_modal_modules.html.twig') }}
        {# --- #}
        {# ---- MODAL PICTURES/BANNERS ---- #}
        {{ include('Front/_modal_profile_picture.html.twig') }}
        {{ include('Front/_modal_banner_picture.html.twig') }}
        {# ----- #}

        {# ---- USER PROG LANGUAGE DATA ---- #}
        <div class="user-proglanguage" data-userProgLanguage="{{ user.jsonUserProgLanguages | json_encode }}">
        </div>
        {# ----- #}

    {% endif %}
{% endblock %}

{% block javascripts %}
    {% if edit %}
        {{ encore_entry_script_tags('app') }}
    {% else %}
        {{ encore_entry_script_tags('app_offline') }}
    {% endif %}
{% endblock %}

{% block footer %}
    {{ include('_footer.html.twig') }}
{% endblock %}